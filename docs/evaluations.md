# Evaluating predictions from PickET

## Centroid-based evaluation:
This workflow computes the precision, recall and F1-score for the predicted centroids by comparing the distance between a predicted the shortest Euclidean distance between predicted centroids and ground truth centroids.

Along with these computations, $N$ (where $N=\text {number of predictions from PickET}$) number of random predictions are also made to get the random baseline. 

These computations are made using the [centroid assessment script](../evaluations/centroid_assessment.py) which can be run as follows:
```bash
python evaluations/centroid_assessment.py assessment_params.yaml
```

where `assessment_params.yaml` is a configurations file for the assessment. A detailed description of this file can be found in the [example](../example/assessment_params_example.yaml).

<br>

## Compare all the workflows
All the workflows can be compared after computing the centroid based evaluation by running the [comparison script](../plotting/compare_workflows.py) as follows:
```bash
python plotting/compare_workflows.py <metric> <dataset_id> <output_dir> <path_to_centroid-based_evaluation_output/*.yaml>
```
where `metric` can be `Precision`,`Recall`, `F1-score`, etc. Essentially, it can be any of the keys from the evaluation output files.

<br>

## Compute particle-wise recall
We also checked which particles were most likely to get picked in order to then understand the characteristics of a particle that made it more likely to be picked by PickET. This was done by running the [particle-wise recall script](../evaluations/particle_wise_recall.py) as follows:
```bash
python evaluations/particle_wise_recall.py assessment_params.yaml
```
This script generates a `.yaml` file which contains the average recall across all tomograms for each particle type as specified in the ground truth file. This file can be better visualized as a scatter plot which can be generated by the following scripts:
1. [For TomoTwin tomograms](plotting/plot_particlewise_recall_tomotwin.py)
2. [For CZI tomograms](plotting/plot_particlewise_recall_czi.py)

These scripts can be run as follows:
1. For TomoTwin tomograms:
```bash
python plotting/plot_particlewise_recall_tomotwin.py <particle-wise_recall_fpath> <particle_details_fname>
```
The [particle_details_fname](../evaluations/tomotwin_particles.yaml) contains the details of each particle type in the dataset such as the molecular weight, radius of gyration, etc.

2. for CZI tomograms:
```bash
python plotting/plot_particlewise_recall_czi.py <particle-wise_recall_fpath> <dataset_name>
```
